<html>
    <head>
        <script src="https://unpkg.com/@kitware/trame-vtklocal@1.0.2/dist/umd/viewer.umd.js"></script>
    </head>
    <body style="margin:0">
        <div id="viewer"></div>
        <script>
            vtkWASMViewer.createViewer(
                "#viewer",
                "/vtk-wasm/data/porsche.wazex",
                "/vtk-wasm/wasm32/9.5.0",
                {
                    rendering: 'webgl',
                },
            ).then((viewer) => {
                // ------------------------------------------------------------
                // enable picking in pure JS
                // ------------------------------------------------------------
                const renderWindow = viewer.remoting.getVtkObject(1);
                const renderer = viewer.remoting.getVtkObject(3);
                const property = viewer.remoting.getVtkObject(515);
                const picker = viewer.remoting.getVtkObject(513);
                const interactor = viewer.remoting.getVtkObject(509);
                // ------------------------------------------------------------

                let pickingPending = false;
                let lastActor = null;

                async function pick() {
                    if (pickingPending) {
                        return;
                    }
                    try {
                        pickingPending = true;
                        const pos = interactor.state.EventPosition;
                        const found = await picker.Pick([...pos, 0], renderer);
                        if (found) {
                            if (lastActor) {
                                (await lastActor.GetProperty()).DeepCopy(property);
                            }
                            lastActor = await picker.GetActor();
                            const actorProp = await lastActor.GetProperty();
                            await property.DeepCopy(actorProp);
                            await actorProp.SetColor(1, 0, 1);
                            await actorProp.EdgeVisibilityOn();
                        }
                        await renderWindow.Render();
                    } finally {
                        pickingPending = false;
                    }
                }
                interactor.observe("MouseMoveEvent", pick);
            });
        </script>
    </body>
</html>