(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(t){if(t.ep)return;t.ep=!0;const s=r(t);fetch(t.href,s)}})();const j=[],P={};function k(){let e,n;return{promise:new Promise((r,o)=>{e=r,n=o}),resolve:e,reject:n}}function C(e){return e!=null&&e.Id?e:JSON.parse(e)}function N(e){return e!=null&&e.Id?JSON.stringify(e):e}function E(e,n){return e.rendering===n.rendering&&e.exec===n.exec}function W(e){return(e==null?void 0:e.rendering)==="webgpu"?(console.log("WASM use WebGPU"),{preRun:[function(n){n.ENV.VTK_GRAPHICS_BACKEND="WEBGPU"}]}):(console.log("WASM use WebGL2"),{})}function K(e){return P[e]||(P[e]=new Promise(function(n,r){if(j.indexOf(e)===-1){j.push(e);var o=document.createElement("script");o.type="module",o.src=e,o.onload=n,o.onerror=r,document.body.appendChild(o)}else n(!1)})),P[e]}class V{constructor(){this.loaded=!1,this.loadingPending=null,this.wasm=null,this.config={},this.runtimes=[]}async load(n,r={rendering:"webgl",exec:"sync"}){var o,t;if(this.config=r,!this.loaded)if(this.loadingPending)await this.loadingPending;else{const{promise:s,resolve:l}=k();if(this.loadingPending=s,((o=this.config)==null?void 0:o.rendering)==="webgpu"&&(this.config.exec="async"),!window.createVTKWASM){let d=null;document.querySelectorAll("script").forEach(u=>{if(u.src.includes("vtkWebAssemblyInterface")){const{promise:y,resolve:i}=k();u.onload=i,d=y}}),d&&await d}if(!window.createVTKWASM){let d=null,u=null;if(d=`${n}/vtkWebAssemblyInterface${((t=this.config)==null?void 0:t.exec)==="async"?"Async":""}.mjs`,(await fetch(d)).ok&&(u=d),u||(d=`${n}/vtkWasmSceneManager.mjs`,(await fetch(d)).ok&&(u=d)),!u)throw new Error(`Could not fetch wasm bundle from ${n}`);console.log("WASM use",u),await K(u)}window.createVTKWASM&&(this.wasm=await window.createVTKWASM(W(this.config))),this.loaded=!0,l()}}async createRemoteSession(n){var r;if(this.wasm)if((r=this.wasm)!=null&&r.isAsync&&this.wasm.isAsync()){if(!n||E(this.config,n))return console.log("(Main runtime in async)"),new this.wasm.vtkRemoteSession;{console.log("(New in async)");const t=await window.createVTKWASM(W(n||this.config));return new t.vtkRemoteSession}}else{console.log("(New in sync)");const t=await window.createVTKWASM(W(n||this.config));return new t.vtkRemoteSession}const o=await window.createVTKWasmSceneManager();return o.initialize(),o}createStandaloneSession(){if(!this.wasm)throw new Error("Current WASM version does not support standalone mode");return new this.wasm.vtkStandaloneSession}createStateDecorator(){return this.wasm?C:N}}function T(e,n,r){const o=e.get(r),t={};return Object.keys(o).forEach(s=>{t[s]=()=>n.decorateResult(e.get(r)[s])}),t}function D(e,n,r){const o=e.get(r),t={};return Object.keys(o).forEach(s=>{t[s]=l=>e.set(r,n.decorateKwargs({[s]:l}))}),t}function M(e,n,r,o,t){if(r.has(t)&&r.get(t).deref())return r.get(t).deref();const s=[];function l(w){return e.set(t,o.decorateKwargs(w))}function d(w,a){const p=e.observe(t,w,a);return s.push(p),p}function u(w){const a=s.indexOf(w);return a!==-1&&s.splice(a,1),e.unObserve(t,w)}function y(){for(;s.length;)u(s.pop())}const i=T(e,o,t),c=D(e,o,t),f={id:t,obj:{Id:t},set:l,observe:d,unObserve:u,unObserveAll:y},h=new Proxy(f,{get(w,a,p){return a==="then"?p:a==="state"?e.get(t):i[a]?i[a]():(w[a]||(w[a]=async(...v)=>o.decorateResult(await e.invoke(t,a,o.decorateArgs(v)))),w[a])},set(w,a,p){return c[a]&&c[a](p),p}});return r.set(t,new WeakRef(h)),n.set(h,!0),h}function G(e,n,r){function o(i){return n.has(i)}function t(i){const c={};return Object.entries(i).forEach(([f,h])=>{n.has(h)?c[f]=h.obj:c[f]=h}),c}function s(i){return i.map(c=>n.has(c)?c.obj:c)}const l={isVtkObject:o,decorateKwargs:t,decorateArgs:s};function d(i){return i==null?i:i!=null&&i.Id?M(e,n,r,l,i.Id):i}l.decorateResult=d;function u(i){return M(e,n,r,l,i.Id||i)}function y(i,c){const f=e.create(i);return c&&e.set(f,t(c)),M(e,n,r,l,f)}return new Proxy({toObject:u},{get(i,c,f){return c==="then"?f:(i[c]||(i[c]=h=>y(c,h)),i[c])}})}async function I(e,n={}){const r=new WeakMap,o=new Map,t=new V;await t.load(e||"loaded-module",n);const s=t.createStandaloneSession();return G(s,r,o)}const{promise:$,resolve:q,reject:J}=k(),R=document.querySelector("#vtk-wasm");if(R){const e=R.dataset.url||".",n=JSON.parse(R.dataset.config||"{}");window.vtkReady=$,I(e,n).then(r=>{window.vtk=r,q(r)})}else J('No script with id="vtk-wasm"');async function L(e,n="#vtk-wasm-window"){function r(a,p){const v=[];for(let g=0;g<p+1;g++)for(let m=0;m<a+1;m++){const A=(m-.5*a)/a,b=(g-.5*p)/p;v.push(A),v.push(b),v.push(2*Math.sqrt(A*A+b*b)*Math.sin(A)*Math.cos(b))}const S=[],O=[];for(let g=0;g<p;g++)for(let m=0;m<a;m++)O.push(S.length),S.push(m+g*(a+1)),S.push(m+g*(a+1)+1),S.push(m+g*(a+1)+a+2),S.push(m+g*(a+1)+a+1);return O.push(S.length),{points:v,offsets:O,connectivity:S}}const o=r(50,50),t=e.vtkPoints(),s=e.vtkCellArray(),l=e.vtkTypeInt32Array(),d=e.vtkTypeInt32Array();await t.Data.SetArray(new Float32Array(o.points)),await l.SetArray(new Int32Array(o.connectivity)),await d.SetArray(new Int32Array(o.offsets)),await s.SetData(d,l);const u=e.vtkPolyData();u.set({Points:t,Polys:s}),console.log("NumberOfPoints:",await u.GetNumberOfPoints()),console.log("NumberOfCells:",await u.GetNumberOfCells()),console.log("PolyDataBounds:",await u.GetBounds());const y=e.vtkPolyDataMapper();await y.SetInputData(u);const i=e.vtkActor({Mapper:y});i.Property.EdgeVisibility=!0;const c=e.vtkRenderer();await c.AddActor(i),await c.ResetCamera();const f=e.vtkRenderWindow({CanvasSelector:n});await f.AddRenderer(c);const h=e.vtkRenderWindowInteractor({CanvasSelector:n,RenderWindow:f});await h.Render(),await h.Start();const w=f.observe("StartEvent",()=>{console.log("Camera position",c.ActiveCamera.Position)});setTimeout(()=>{f.unObserve(w),f.unObserveAll(),console.log("Camera state:",c.ActiveCamera.state)},3e4)}I().then(e=>{document.querySelector("#app").appendChild("canvas"),L(e,"#app > canvas")});
